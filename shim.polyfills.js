window.JSONP=window.JSONP||{};(function(){const o=window.JSONP.fetch;window.JSONP.fetch=function(u){const s=u||(window.CONFIG&&window.CONFIG.DOGET_URL);if(!s)return Promise.reject(new Error("JSONP: URL mancante"));if(typeof o==="function")return o.call(window.JSONP,s);return fetch(s,{cache:"no-store"}).then(r=>r.json())};})();window.fetchModel=function(success,failure){const u=window.CONFIG&&window.CONFIG.DOGET_URL;if(!u){const e=new Error("CONFIG.DOGET_URL mancante");if(typeof failure==="function")failure(e);return Promise.reject(e);}const run=()=>fetch(u,{cache:"no-store"}).then(r=>r.json()).catch(()=>JSONP.fetch(u));const p=run();if(typeof success==="function"){p.then(success).catch(failure||console.error);return;}return p;};window.fetchLogs=function(success,failure){const u=window.CONFIG&&window.CONFIG.DOGET_URL;if(!u){const e=new Error("CONFIG.DOGET_URL mancante");if(typeof failure==="function")failure(e);return Promise.reject(e);}const url=u+(u.includes("?")?"&":"?")+"logs=1";const p=fetch(url,{cache:"no-store"}).then(r=>r.json()).catch(()=>JSONP.fetch(url));if(typeof success==="function"){p.then(success).catch(failure||console.error);return;}return p;};window.callAdmin=function(ev,payload,onOk,onErr){try{const u=window.CONFIG&&window.CONFIG.DOGET_URL;if(!u)throw new Error("CONFIG.DOGET_URL mancante");const body=Object.assign({event:String(ev||"")},payload||{});fetch(u,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(body)}).then(r=>r.text()).then(()=>{if(typeof onOk==="function")onOk();}).catch(e=>{if(typeof onErr==="function")onErr(e);});}catch(e){if(typeof onErr==="function")onErr(e);}};